# scripts/mlp/helmholtz2d.sh
# scripts/mlp/z_helmholtz2d_fore.sh

tag: extra_noise_naPINN_3
device: cuda

domain:
  x: [-1.0, 1.0]
  y: [-1.0, 1.0]
  t: [-1.0, 1.0]
k: 2.0
c: 1.0
omega: auto
in_features: 3 # (x,y,t) or (x,y); here steady: use (x,y)
out_features: 1
time_dependent: true

# sampling
sampling_mode: grid # random / grid
grid:
  nx: 80
  ny: 80
  nt: 40
batch:
  n_f: 4096
  n_b: 1024
  n_0: 1024

# noise
noise:
  enabled: true
  n_train: 3000
  batch_size: 700
  kind: 3G # G, Goff, sG, u, 3G, 3G0, mix0, Gmix, rmix, sGtest

  extra_noise:
    enabled: true
    n_points: 600
    scale_min: 30.0
    scale_max: 50.0

# phase
phase:
  enabled: true
  phase1_epochs: 10000
  phase2_epochs: 20000

ebm:
  enabled: true
  hidden_dim: 32
  depth: 3
  num_grid: 256
  max_range_factor: 2.5
  lr: 1.0e-3
  use_nll: false

data_loss_balancer:
  use_loss_balancer: true
  kind: pw # pw, inverse

offset:
  enabled: false
  init: 0.0

# video
video:
  enabled: true
  every: 5000
  grid:
    nx: 150
    ny: 150
    nt: 70
  fps: 10
  format: mp4