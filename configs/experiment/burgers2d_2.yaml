# simulation run: scripts/simulation/burgers_2.sh
# experiment(back) run: scripts/mlp/burgers2d_2.sh
# experiment(fore) run: scripts/mlp/z_burgers2d_2_fore.sh

# common
domain:
  x: [0.0, 2.0] # 2x2 Domain
  y: [0.0, 2.0]
  burn_in_time: 0.1 # Short burn-in to let initial noise smooth slightly
  record_time: 1.0  # Duration of simulation

nu: 0.002     # LOW VISCOSITY -> Sharper shocks, harder to learn

# simulation
simulation_tag: "Burgers2D_2"
dir_path: pinnlab/simulation/simulation_result/

simulation_points:
  nx: 128     # Higher resolution needed for turbulence
  ny: 128
  dt: 0.0001  # Smaller timestep for stability at low viscosity
  every: 100   # Save every 100 steps

n_measurement: 20000

# experiment

tag: 2_naPINN_1t
device: cuda

noise:
  enabled: true
  n_train: 20000
  batch_size: 4000
  kind: 3G # G, Goff, sG, u, 3G, 3G0, mix0, Gmix, rmix, sGtest, MG2D
  
  scale: 0.1 # not used in the recent version
  # relative_scale: 0.01  # 1% relative error proportional to velocity
  # floor_scale: 0.1     # 10% of global mean as minimum noise floor

  extra_noise:
    enabled: true
    n_points: 4000
    scale_min: 30.0
    scale_max: 50.0

# phase
phase:
  enabled: true # true / false
  phase1_epochs: 10000
  phase2_epochs: 10000

ebm:
  enabled: true
  kind: 1D # 1D / 2D
  hidden_dim: 32
  depth: 3
  num_grid: 256
  max_range_factor: 2.5
  lr: 1.0e-3
  use_nll: false
  init_train_epochs: 3000

data_loss:
  kind: mse # mse, L1, q_gaussian
  # q-Gaussian settings
  q: 2.0
  beta: null

data_loss_balancer:
  use_loss_balancer: true # true / false
  kind: gated_trainable # pw, inverse, mlp, gated, gated_trainable
  weight_net:
    hidden_dim: 32
    depth: 3

# Model I/O
in_features: 3   # (x,y,t)
out_features: 2  # (u,v)

offset:
  enabled: false
  init: 0.0

# video
video:
  enabled: true
  every: 10000
  grid:
    nx: 128
    ny: 128
    nt: 100
  fps: 10
  format: mp4