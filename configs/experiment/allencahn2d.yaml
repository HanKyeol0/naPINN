# scripts/mlp/allencahn2d.sh
# scripts/mlp/z_allencahn2d_fore.sh

tag: b3_na # na / va / L1 / qG2 / qG3
device: cuda

domain:
  x: [0.0, 2.0]
  y: [0.0, 2.0]
  t: [0.0, 2.0]
in_features: 3
out_features: 1

pde:
  learn_eps: true # true / false
  omega: 8.0
  init_eps: 1.0
  eps: 0.3

# sampling
sampling_mode: grid # random / grid
grid:
  nx: 100
  ny: 100
  nt: 100
batch:
  n_f: 4000

# noise
noise:
  enabled: true
  n_train: 5000
  batch_size: 1000
  kind: G # G, Goff, sG, u, 3G, 3G0, mix0, Gmix, rmix, sGtest
  scale: 0.1 # default: 0.1
  pars: [0.0, 4.0]

  sensor_mode: fixed_random # random / fixed_random / fixed_grid
  n_sensors: 100 # only for fixed_random
  sensor_nx: 10 # only for fixed_grid
  sensor_ny: 10 # only for fixed_grid

  extra_noise:
    enabled: true
    kind: std # 'std' or 'mean_level'
    n_points: 500
    scale_min: 5.0
    scale_max: 30.0

# phase
phase:
  enabled: true # true / false
  phase1_epochs: 10000
  phase2_epochs: 30000

ebm:
  enabled: true
  hidden_dim: 32
  depth: 4
  num_grid: 1024
  max_range_factor: 2.5
  lr: 1.0e-3
  use_nll: false
  init_train_epochs: 5000

data_loss:
  kind: mse # mse, L1, q_gaussian
  # q-Gaussian settings
  q: 1.9 # 1.9 / 2.9
  beta: null

data_loss_balancer:
  use_loss_balancer: true # true / false
  kind: gated_trainable # pw, inverse, mlp, gated, gated_trainable
  weight_net:
    hidden_dim: 32
    depth: 3

offset:
  enabled: false
  init: 0.0

# video
video:
  enabled: true
  every: 10000
  grid:
    nx: 120
    ny: 120
    nt: 120
  fps: 10
  format: mp4